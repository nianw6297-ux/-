# app.py
import streamlit as st, pandas as pd, matplotlib.pyplot as plt
from io import BytesIO
st.set_page_config(page_title="å…­åˆå½©ç»Ÿè®¡", layout="wide")
st.title("ğŸ“± æ‰‹æœºå…­åˆå½©ç»Ÿè®¡å™¨")
upload = st.file_uploader("ä¸Šä¼  CSV/Excel", type=["csv","xlsx"])
if upload:
    df = pd.read_csv(upload) if upload.name.endswith("csv") else pd.read_excel(upload)
    st.write("é¢„è§ˆå‰5æœŸ", df.head())
    c = {"å¤§å°": {n:0 for n in ["å¤§","å°"]},
         "å•åŒ": {n:0 for n in ["å•","åŒ"]}}
    z = {i+1:0 for i in range(12)}
    for row in df.itertuples(index=False):
        for n in row:
            n = int(n)
            c["å¤§å°"]["å¤§" if n>=25 else "å°"] += 1
            c["å•åŒ"]["å•" if n%2 else "åŒ"] += 1
            z[(n-1)%12+1] += 1
    cols = st.columns(3)
    for col, k in zip(cols, ["å¤§å°","å•åŒ"]):
        fig, ax = plt.subplots(); ax.bar(c[k].keys(), c[k].values()); ax.set_title(k); col.pyplot(fig)
    st.bar_chart(pd.Series(z, name="å‡ºç°æ¬¡æ•°"))
    st.download_button("ğŸ“¥ å¯¼å‡º CSV", df.to_csv(index=False), "result.csv")
